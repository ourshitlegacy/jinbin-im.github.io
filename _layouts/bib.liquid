---
---
{% raw %}
<style>
.author-me {
  color: #7b27d8 !important;
  font-weight: 700 !important;
  font-style: normal !important;
  text-decoration: none !important;
}

/* 저널 메트릭스 배지 스타일 */
.journal-metrics {
  display: inline-flex;
  gap: 5px;
  margin-left: 8px;
  align-items: center;
  flex-wrap: wrap;
}

.metric-badge {
  display: inline-block;
  padding: 3px 8px;
  border-radius: 12px;
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  white-space: nowrap;
}

.metric-scie {
  background: #efe7fb;
  color: #333;
}

.metric-ahci {
  background: #e5f6f8;
  color: #333;
}

.metric-top {
  background: #7b27d8;
  color: white;
}

.metric-if {
  background: #e0e0e0;
  color: white;
}

.pub-year {
  color: #555 !important;
}

/* 제목 링크 스타일 */
.title a {
  color: inherit;
  text-decoration: none;
}

.title a:hover {
  color: #7b27d8;
  text-decoration: underline;
}

/* Abstract/Bibtex 숨김 스타일 */
.abstract.hidden,
.bibtex.hidden {
  display: none;
}

.abstract,
.bibtex {
  margin-top: 1rem;
  padding: 1rem;
  background: #f8f9fa;
  border-left: 3px solid #7b27d8;
  border-radius: 4px;
}
</style>
{% endraw %}

<div class="row">
   {% if site.enable_publication_thumbnails %}
    <div class="col col-sm-2 abbr">
      {%- if entry.abbr -%}
        {%- if site.data.venues[entry.abbr] -%}
          {% assign venue_style = null %}
          {% if site.data.venues[entry.abbr].color != blank %}
            {% assign venue_style = site.data.venues[entry.abbr].color | prepend: 'style="background-color:' | append: '"' %}
          {%- endif -%}
          <abbr
            class="badge rounded w-100"
            {% if venue_style %}
              {{ venue_style }}
            {% endif -%}
          >
            {% if site.data.venues[entry.abbr].url %}
              <a href="{{ site.data.venues[entry.abbr].url }}">{{ entry.abbr }}</a>
            {% else %}
              <div>{{- entry.abbr -}}</div>
            {% endif %}
          </abbr>
        {% else %}
          <abbr class="badge rounded w-100">{{ entry.abbr }}</abbr>
        {% endif %}
      {% endif %}
      {% if entry.preview %}
        {% if entry.preview contains '://' %}
          <img class="preview z-depth-1 rounded" src="{{ entry.preview }}">
        {% else %}
          {% assign entry_path = entry.preview | prepend: '/assets/img/publication_preview/' %}
          {%
            include figure.liquid
            loading="eager"
            path=entry_path
            sizes = "200px"
            class="preview z-depth-1 rounded"
            zoomable=true
            avoid_scaling=true
            alt=entry.preview
          %}
        {% endif %}
      {% endif %}
    </div>
  {% endif %}

  <div id="{{entry.key}}" class="col-sm-8">
    {% if entry.type == "thesis" %}
      {{reference}}
    {% else %}
      <!-- 제목 with 링크 -->
      <div class="title">
        {% if entry.doi %}
          <a href="https://doi.org/{{ entry.doi }}" target="_blank">{{entry.title}}</a>
        {% elsif entry.url %}
          <a href="{{ entry.url }}" target="_blank">{{entry.title}}</a>
        {% else %}
          {{entry.title}}
        {% endif %}
      </div>

      <!-- 저자 -->
      <div class="author">
        {% assign author_array_size = entry.author_array | size %}
        
        {%- for author in entry.author_array -%}
          {%- assign author_is_self = false -%}
          {%- assign author_last_name = author.last | remove: "¶" | remove: "&" | remove: "*" | remove: "†" | remove: "^" -%}
          {%- if site.scholar.last_name contains author_last_name -%}
            {%- if site.scholar.first_name contains author.first -%}
              {%- assign author_is_self = true -%}
            {%- endif -%}
          {%- endif -%}
          {%- assign coauthor_url = nil -%}
          {%- assign clean_last_name = author_last_name | downcase | remove: "." -%}
          {%- if site.data.coauthors[clean_last_name] -%}
            {%- for coauthor in site.data.coauthors[clean_last_name] -%}
              {%- if coauthor.firstname contains author.first -%}
                {%- assign coauthor_url = coauthor.url -%}
                {%- break -%}
              {%- endif -%}
            {%- endfor -%}
          {%- endif -%}
          
          {% if author_is_self %}
            <span class="author-me">{{author.first}} {{author.last}}</span>
          {% else %}
            {% if coauthor_url %}
              <a href="{{coauthor_url}}">{{author.first}} {{author.last}}</a>
            {% else %}
              {{author.first}} {{author.last}}
            {% endif %}
          {% endif %}
          
          {%- if forloop.last == false -%}
            {%- if forloop.index == author_array_size | minus: 1 -%}
              , and&nbsp;
            {%- else -%}
              ,&nbsp;
            {%- endif -%}
          {%- endif -%}
        {%- endfor -%}
      </div>

      <!-- 저널 정보 with 배지 -->
      <div class="periodical">
        <em>{{entry.journal}}</em>
        {% if entry.note %}
          {% assign note_text = entry.note %}
          <span class="journal-metrics">
            {% if note_text contains "SCI-E" or note_text contains "SCIE" %}
              <span class="metric-badge metric-scie">SCI-E</span>
            {% endif %}
            {% if note_text contains "A&HCI" or note_text contains "AHCI" %}
              <span class="metric-badge metric-ahci">A&HCI</span>
            {% endif %}
            {% if note_text contains "%" %}
              {% assign percentage = note_text | split: "(" | last | split: "%" | first %}
              <span class="metric-badge metric-top">Top {{ percentage }}%</span>
            {% endif %}
            {% if note_text contains "IF" %}
              {% assign if_value = note_text | split: "IF" | last | strip %}
              <span class="metric-badge metric-if">IF {{ if_value }}</span>
            {% endif %}
          </span>
        {% endif %}
      </div>
    {% endif %}

    <!-- 버튼들 -->
    <div class="links">
      {%- if entry.abstract %}
        <a class="abstract-btn btn btn-sm z-depth-0" role="button">Abs</a>
      {%- endif %}
      {%- if entry.arxiv %}
        <a href="http://arxiv.org/abs/{{ entry.arxiv }}" class="btn btn-sm z-depth-0" role="button" target="_blank">arXiv</a>
      {%- endif %}
      {%- if entry.bibtex_show %}
        <a class="bibtex-btn btn btn-sm z-depth-0" role="button">Bib</a>
      {%- endif %}
      {%- if entry.pdf %}
        {% if entry.pdf contains '://' %}
          <a href="{{ entry.pdf }}" class="btn btn-sm z-depth-0" role="button" target="_blank">PDF</a>
        {% else %}
          <a href="{{ entry.pdf | prepend: '/assets/pdf/' | relative_url }}" class="btn btn-sm z-depth-0" role="button" target="_blank">PDF</a>
        {% endif %}
      {%- endif %}
    </div>

    <!-- 숨김 영역: 초록 -->
    {% if entry.abstract %}
      <div class="abstract hidden">
        <p>{{ entry.abstract }}</p>
      </div>
    {% endif %}

    <!-- 숨김 영역: BibTeX -->
    {% if entry.bibtex_show %}
      <div class="bibtex hidden">
        {% highlight bibtex %}{{ entry.bibtex }}{% endhighlight %}
      </div>
    {% endif %}
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Abstract toggle
  document.querySelectorAll('.abstract-btn').forEach(function(btn) {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      var row = this.closest('.row');
      var abstractDiv = row.querySelector('.abstract');
      if (abstractDiv) {
        abstractDiv.classList.toggle('hidden');
      }
    });
  });

  // Bibtex toggle
  document.querySelectorAll('.bibtex-btn').forEach(function(btn) {
    btn.addEventListener('click', function(e) {
      e.preventDefault();
      var row = this.closest('.row');
      var bibtexDiv = row.querySelector('.bibtex');
      if (bibtexDiv) {
        bibtexDiv.classList.toggle('hidden');
      }
    });
  });
});
</script>
